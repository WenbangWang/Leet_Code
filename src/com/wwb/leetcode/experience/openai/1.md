https://www.1point3acres.com/bbs/thread-1068066-1-1.html

coding : https://www.1point3acres.com/bbs ... 21&pid=19478077 db 操作。没准备到，用 Java 一顿猛写， 把 where Claus 写完， test 都过了。 没来的急写 order by

原题就是要你模仿SQL，建一个in memory DB（其实就是一个map），给你一个列表的column name然后建table，要求你实现add row, query row by a single column name, query row by multiple column name (支持AND或者OR），支持greater or less than的query，还有最后支持order by。不需要你去parse SQL statement，写出支持相关功能的API就行。但实际写起来代码量很大，几个checkpoint都需要现场编译跑过，非常不建议用Java，时间不够的。


system design： 钩子。 基本按照这个兄弟的思路 https://pyemma.github.io/How-to-Design-Webhook/


面试反馈， system design 很好， 但 coding 需要 improve， 问可不可以加面·一轮， 同意了。
加面就是versioned KV store , 20 分钟快速撸完。 然后 follow up 有点没明白要问什么。意思是貌似要 make update consistent 到最后也不知道要问什么。 是烙印，口音重，外加他 microphone 效果不好，听不太清楚。

1. Make update consistency even in multithreading。
   我的理解因为多线程的情况下会产生一起update一个key with same timestamp，所以这个情况就是需要加锁保证同一时间只有一个update或者用thread safe的data structure。
2. when invoke get, pass in a future timestamp. my answer was to add a sleep in the get implementation, wait for the time to reach the input timestamp and proceed.  
我的理解是可以define system rule来处理这个情况，譬如说return null，或者说return latest value。如果sleep 太容易 block thread了，如果给了1000年以后的时间，等在那的话在锁的环境下，基本就是deadlock了。

coding 给了三个
* db， 这个貌似是新题，我面之前没看到题，只能现场撸了
* ads click aggregator
* iterator
* versioned kv store
  SD 给了两个
* Twitter, FB, Github like
* Yelp, Uber like
* slack
  * DM chat & channel chat & thread chat & cold start & delete message，所以时间非常紧张，只把functional过完就花了一大半时间了，来不及dive deep。
  * https://systemdesign.one/slack-architecture/
  * https://pyemma.github.io/How-to-design-slack/
  *    设计了channel service（单独管理user和channel信息）  和message service （管理msg) 细问了msg id如何generate, loose ordering of msg delivery 但是万一msg出现在exactly同一时刻怎么办  
   还有channel service 怎么设计数据库table 说了设计了one to many保存user2channels channel2users的read prioritized的存法   
    感觉大头的delivery部分我说用webhook发给slack client 我没来得及说已经快结束了  总体来说lz这题准备完全不充分
